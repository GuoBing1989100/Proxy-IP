<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>代理IP优选中心 - 智能筛选系统</title>
    
    <!-- 缓存控制 -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🚀</text></svg>">
    
    <link rel="stylesheet" href="css/style.css?v=20251212-003">
</head>
<body data-theme="dark">
    <!-- 背景动画 -->
    <div class="bg-animation">
        <div class="bg-circle"></div>
        <div class="bg-circle"></div>
        <div class="bg-circle"></div>
    </div>

    <div class="container">
        <!-- 顶部导航栏 -->
        <div class="header">
            <div class="header-content">
                <div class="logo">
                    <span class="logo-icon">🚀</span>
                    <div class="logo-text">
                        <h1>代理IP优选中心</h1>
                        <p class="subtitle">智能筛选 · 一键测速 · 实时更新</p>
                    </div>
                </div>
                <div class="header-actions">
                    <button onclick="toggleTheme()" class="theme-btn" title="切换主题">
                        <span class="icon" id="themeIcon">🌙</span>
                        <span class="text">主题</span>
                    </button>
                    <button onclick="openFavorites()" class="favorites-btn" title="收藏夹">
                        <span class="icon">⭐</span>
                        <span class="text">收藏</span>
                        <span class="badge" id="favoritesBadge">0</span>
                    </button>
                    <button onclick="clearCacheAndReload()" class="refresh-btn" title="强制刷新">
                        <span class="icon">🔄</span>
                        <span class="text">刷新</span>
                    </button>
                    <button onclick="exportData()" class="export-btn" title="导出数据">
                        <span class="icon">📥</span>
                        <span class="text">导出</span>
                    </button>
                </div>
            </div>
            
            <!-- 更新时间提示 -->
            <div class="update-info">
                <span class="pulse-dot"></span>
                <span id="updateTime">数据实时同步中...</span>
            </div>
        </div>

        <!-- 快捷操作栏 -->
        <div class="quick-actions">
            <div class="quick-action-item" onclick="recommendFastest()">
                <div class="quick-icon">⚡</div>
                <div class="quick-text">
                    <div class="quick-title">智能推荐</div>
                    <div class="quick-desc">推荐最佳代理</div>
                </div>
            </div>
            <div class="quick-action-item" onclick="showPopularCountries()">
                <div class="quick-icon">🔥</div>
                <div class="quick-text">
                    <div class="quick-title">热门国家</div>
                    <div class="quick-desc">查看热门代理</div>
                </div>
            </div>
            <div class="quick-action-item" onclick="testSpeed()">
                <div class="quick-icon">🎯</div>
                <div class="quick-text">
                    <div class="quick-title">批量测速</div>
                    <div class="quick-desc">测试代理速度</div>
                </div>
            </div>
            <div class="quick-action-item" onclick="showStats()">
                <div class="quick-icon">📊</div>
                <div class="quick-text">
                    <div class="quick-title">数据统计</div>
                    <div class="quick-desc">可视化分析</div>
                </div>
            </div>
        </div>

        <!-- 统计面板 -->
        <div class="stats-panel">
            <div class="stat-card animated">
                <div class="stat-icon">📊</div>
                <div class="stat-info">
                    <span class="stat-label">总代理数</span>
                    <span class="stat-value" id="totalCount">0</span>
                    <span class="stat-trend">实时更新</span>
                </div>
            </div>
            <div class="stat-card animated">
                <div class="stat-icon">✅</div>
                <div class="stat-info">
                    <span class="stat-label">筛选结果</span>
                    <span class="stat-value" id="filteredCount">0</span>
                    <span class="stat-trend" id="filterTrend">未筛选</span>
                </div>
            </div>
            <div class="stat-card animated">
                <div class="stat-icon">🌍</div>
                <div class="stat-info">
                    <span class="stat-label">国家数量</span>
                    <span class="stat-value" id="countryCount">0</span>
                    <span class="stat-trend">全球覆盖</span>
                </div>
            </div>
            <div class="stat-card animated">
                <div class="stat-icon">🔌</div>
                <div class="stat-info">
                    <span class="stat-label">端口类型</span>
                    <span class="stat-value" id="portCount">0</span>
                    <span class="stat-trend">多端口支持</span>
                </div>
            </div>
        </div>

        <!-- 筛选控制面板 -->
        <div class="controls-panel">
            <div class="controls-header">
                <h2>🔍 智能筛选</h2>
                <div class="controls-actions">
                    <button onclick="saveFilter()" class="save-filter-btn">
                        💾 保存筛选
                    </button>
                    <button onclick="loadFilter()" class="load-filter-btn">
                        📂 加载筛选
                    </button>
                    <button onclick="resetFilters()" class="reset-btn">
                        ↺ 重置
                    </button>
                </div>
            </div>
            
            <div class="controls-grid">
                <div class="control-item">
                    <label>
                        <span class="control-icon">🔎</span>
                        <span class="control-label">关键词搜索</span>
                    </label>
                    <div class="search-wrapper">
                        <input type="text" id="searchInput" placeholder="搜索 IP、国家或公司..." class="control-input">
                        <div class="search-history" id="searchHistory"></div>
                    </div>
                </div>

                <div class="control-item">
                    <label>
                        <span class="control-icon">🌐</span>
                        <span class="control-label">国家地区</span>
                    </label>
                    <select id="countryFilter" class="control-select">
                        <option value="">全部国家</option>
                    </select>
                </div>

                <div class="control-item">
                    <label>
                        <span class="control-icon">🔌</span>
                        <span class="control-label">端口筛选</span>
                    </label>
                    <select id="portFilter" class="control-select">
                        <option value="">全部端口</option>
                    </select>
                </div>

                <div class="control-item">
                    <label>
                        <span class="control-icon">🏢</span>
                        <span class="control-label">运营商/公司</span>
                    </label>
                    <select id="companyFilter" class="control-select">
                        <option value="">全部公司</option>
                    </select>
                </div>

                <div class="control-item">
                    <label>
                        <span class="control-icon">🎚️</span>
                        <span class="control-label">排序方式</span>
                    </label>
                    <select id="sortFilter" class="control-select">
                        <option value="default">默认排序</option>
                        <option value="ip-asc">IP 升序</option>
                        <option value="ip-desc">IP 降序</option>
                        <option value="port-asc">端口 升序</option>
                        <option value="port-desc">端口 降序</option>
                        <option value="country-asc">国家 A-Z</option>
                        <option value="country-desc">国家 Z-A</option>
                    </select>
                </div>

                <div class="control-item">
                    <label>
                        <span class="control-icon">📏</span>
                        <span class="control-label">每页显示</span>
                    </label>
                    <select id="pageSizeFilter" class="control-select" onchange="changePageSize()">
                        <option value="25">25 条/页</option>
                        <option value="50" selected>50 条/页</option>
                        <option value="100">100 条/页</option>
                        <option value="200">200 条/页</option>
                    </select>
                </div>
            </div>

            <!-- 快速筛选标签 -->
            <div class="quick-filters" id="quickFilters">
                <span class="quick-filter-label">快速筛选：</span>
            </div>
        </div>

        <!-- 数据表格区域 -->
        <div class="table-section">
            <div class="table-header">
                <h2>📋 代理列表</h2>
                <div class="table-actions">
                    <button onclick="selectAll()" class="action-btn">
                        <span class="icon">☑️</span> 全选
                    </button>
                    <button onclick="copySelected()" class="action-btn">
                        <span class="icon">📋</span> 复制选中
                    </button>
                    <button onclick="addToFavorites()" class="action-btn">
                        <span class="icon">⭐</span> 添加收藏
                    </button>
                    <button onclick="testSelected()" class="action-btn">
                        <span class="icon">🎯</span> 测试选中
                    </button>
                </div>
            </div>

            <div id="loadingMessage" class="loading-container">
                <div class="loading-spinner"></div>
                <p class="loading-text">正在加载代理数据...</p>
                <p class="loading-subtext">首次加载可能需要几秒钟</p>
            </div>

            <div class="table-wrapper">
                <table id="proxyTable" style="display: none;">
                    <thead>
                        <tr>
                            <th class="col-checkbox">
                                <input type="checkbox" id="selectAllCheckbox" onchange="toggleSelectAll()">
                            </th>
                            <th class="col-star">⭐</th>
                            <th class="col-ip">IP地址</th>
                            <th class="col-port">端口</th>
                            <th class="col-country">国家</th>
                            <th class="col-company">运营商/公司</th>
                            <th class="col-speed">速度</th>
                            <th class="col-actions">操作</th>
                        </tr>
                    </thead>
                    <tbody id="proxyTableBody">
                    </tbody>
                </table>

                <div id="noDataMessage" class="no-data-container" style="display: none;">
                    <div class="no-data-icon">🔍</div>
                    <h3>未找到匹配的代理</h3>
                    <p>请尝试调整筛选条件或重置筛选</p>
                    <button onclick="resetFilters()" class="no-data-btn">重置筛选</button>
                </div>
            </div>

            <!-- 分页控制 -->
            <div id="paginationContainer" class="pagination" style="display: none;">
                <button onclick="firstPage()" id="firstBtn" class="page-btn">⏮️ 首页</button>
                <button onclick="prevPage()" id="prevBtn" class="page-btn">← 上一页</button>
                <span class="page-info">
                    第 <input type="number" id="pageInput" min="1" value="1" onchange="goToPage()"> 页，
                    共 <span id="totalPages">1</span> 页
                    （显示 <span id="rangeStart">1</span>-<span id="rangeEnd">50</span>，
                    共 <span id="totalItems">0</span> 条）
                </span>
                <button onclick="nextPage()" id="nextBtn" class="page-btn">下一页 →</button>
                <button onclick="lastPage()" id="lastBtn" class="page-btn">末页 ⏭️</button>
            </div>
        </div>
    </div>

    <!-- 收藏夹弹窗 -->
    <div id="favoritesModal" class="modal" style="display: none;">
        <div class="modal-overlay" onclick="closeFavorites()"></div>
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3>⭐ 我的收藏</h3>
                <button class="modal-close" onclick="closeFavorites()">&times;</button>
            </div>
            <div class="modal-content-body">
                <div id="favoritesList" class="favorites-list"></div>
            </div>
        </div>
    </div>

    <!-- 统计图表弹窗 -->
    <div id="statsModal" class="modal" style="display: none;">
        <div class="modal-overlay" onclick="closeStats()"></div>
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3>📊 数据统计分析</h3>
                <button class="modal-close" onclick="closeStats()">&times;</button>
            </div>
            <div class="modal-content-body">
                <div class="stats-charts">
                    <div class="chart-container">
                        <h4>国家分布 TOP 10</h4>
                        <div id="countryChart" class="chart"></div>
                    </div>
                    <div class="chart-container">
                        <h4>端口使用统计</h4>
                        <div id="portChart" class="chart"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 快捷键提示 -->
    <div class="keyboard-hints" id="keyboardHints">
        <div class="hint-title">⌨️ 快捷键</div>
        <div class="hint-item"><kbd>Ctrl</kbd> + <kbd>F</kbd> 聚焦搜索</div>
        <div class="hint-item"><kbd>Ctrl</kbd> + <kbd>A</kbd> 全选</div>
        <div class="hint-item"><kbd>Ctrl</kbd> + <kbd>C</kbd> 复制选中</div>
        <div class="hint-item"><kbd>Esc</kbd> 关闭弹窗</div>
        <div class="hint-item"><kbd>?</kbd> 显示/隐藏帮助</div>
    </div>

    <!-- 按顺序加载 JS 文件 -->
    <script src="js/config.js?v=20251212-003"></script>
    <script src="js/utils.js?v=20251212-003"></script>
    <script src="js/app.js?v=20251212-003"></script>
</body>
</html>
